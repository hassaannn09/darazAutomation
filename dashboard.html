<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Daraz Automation Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
<style>
  :root {
    --bg: #f5f6fa;
    --surface: #ffffff;
    --card: #ffffff;
    --border: #e8eaf2;
    --border2: #d1d5e8;
    --accent: #f97316;
    --accent2: #6366f1;
    --success: #16a34a;
    --success-bg: #f0fdf4;
    --success-border: #bbf7d0;
    --danger: #dc2626;
    --danger-bg: #fef2f2;
    --danger-border: #fecaca;
    --warn: #ca8a04;
    --warn-bg: #fefce8;
    --text: #1a1a2e;
    --text2: #3d3d5c;
    --muted: #8b8ba7;
    --accent-bg: #fff7ed;
    --accent-border: #fed7aa;
    --accent2-bg: #eef2ff;
    --accent2-border: #c7d2fe;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  .top-bar {
    height: 4px;
    background: linear-gradient(90deg, var(--accent) 0%, var(--accent2) 50%, #a855f7 100%);
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 24px;
  }

  /* Loading overlay */
  #loading-overlay {
    position: fixed;
    inset: 0;
    background: var(--bg);
    z-index: 100;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    transition: opacity 0.4s ease;
  }

  #loading-overlay.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .spinner {
    width: 40px; height: 40px;
    border: 3px solid var(--border2);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.7s linear infinite;
  }

  .loading-text {
    font-size: 13px;
    font-weight: 500;
    color: var(--muted);
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  /* Header */
  header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 40px;
    animation: fadeDown 0.6s ease both;
  }

  .logo-block .eyebrow {
    font-size: 11px;
    font-weight: 600;
    color: var(--accent);
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  h1 {
    font-size: clamp(28px, 4vw, 42px);
    font-weight: 800;
    line-height: 1.1;
    color: var(--text);
    letter-spacing: -1px;
  }

  h1 span { color: var(--accent); }

  .header-right {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 10px;
  }

  .status-pill {
    display: flex;
    align-items: center;
    gap: 8px;
    border-radius: 100px;
    padding: 8px 18px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.5px;
    transition: all 0.3s;
  }

  .status-pill.pass {
    background: var(--success-bg);
    border: 1.5px solid var(--success-border);
    color: var(--success);
  }

  .status-pill.fail {
    background: var(--danger-bg);
    border: 1.5px solid var(--danger-border);
    color: var(--danger);
  }

  .status-pill .dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    animation: pulse 2s infinite;
  }

  .status-pill.pass .dot { background: var(--success); }
  .status-pill.fail .dot { background: var(--danger); }

  .run-time {
    font-size: 11px;
    color: var(--muted);
    font-weight: 400;
  }

  .run-time span { color: var(--text2); font-weight: 500; }

  /* Stats */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-bottom: 28px;
  }

  .stat-card {
    background: var(--card);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    padding: 24px;
    position: relative;
    overflow: hidden;
    animation: fadeUp 0.5s ease both;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04), 0 4px 16px rgba(0,0,0,0.04);
    transition: box-shadow 0.2s, transform 0.2s;
  }

  .stat-card:hover {
    box-shadow: 0 4px 20px rgba(0,0,0,0.10);
    transform: translateY(-2px);
  }

  .stat-card::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    border-radius: 16px 16px 0 0;
  }

  .stat-card:nth-child(1)::after { background: var(--accent2); }
  .stat-card:nth-child(2)::after { background: var(--success); }
  .stat-card:nth-child(3)::after { background: var(--accent); }
  .stat-card:nth-child(4)::after { background: var(--warn); }
  .stat-card { animation-delay: calc(var(--i) * 0.1s); }

  .stat-icon {
    width: 40px; height: 40px;
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px;
    margin-bottom: 14px;
  }

  .stat-card:nth-child(1) .stat-icon { background: var(--accent2-bg); }
  .stat-card:nth-child(2) .stat-icon { background: var(--success-bg); }
  .stat-card:nth-child(3) .stat-icon { background: var(--accent-bg); }
  .stat-card:nth-child(4) .stat-icon { background: var(--warn-bg); }

  .stat-label {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 6px;
  }

  .stat-value {
    font-size: 38px;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 4px;
    letter-spacing: -1px;
  }

  .stat-sub {
    font-size: 12px;
    color: var(--muted);
    font-weight: 400;
  }

  /* Main grid */
  .main-grid {
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 20px;
    margin-bottom: 20px;
  }

  @media (max-width: 768px) { .main-grid { grid-template-columns: 1fr; } }

  /* Panel */
  .panel {
    background: var(--card);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    animation: fadeUp 0.6s ease both;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04), 0 4px 16px rgba(0,0,0,0.04);
  }

  .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 22px;
    border-bottom: 1.5px solid var(--border);
    background: #fafbff;
  }

  .panel-title {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--muted);
  }

  .panel-badge {
    font-size: 11px;
    font-weight: 600;
    padding: 3px 12px;
    border-radius: 100px;
    background: var(--accent-bg);
    color: var(--accent);
    border: 1px solid var(--accent-border);
  }

  /* Steps */
  .steps { padding: 4px 0; }

  .step {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    padding: 14px 22px;
    border-bottom: 1px solid var(--border);
    transition: background 0.2s;
    animation: fadeRight 0.4s ease both;
  }

  .step:hover { background: #fafbff; }
  .step:last-child { border-bottom: none; }

  .step:nth-child(1) { animation-delay: 0.3s; }
  .step:nth-child(2) { animation-delay: 0.4s; }
  .step:nth-child(3) { animation-delay: 0.5s; }
  .step:nth-child(4) { animation-delay: 0.6s; }
  .step:nth-child(5) { animation-delay: 0.7s; }
  .step:nth-child(6) { animation-delay: 0.8s; }
  .step:nth-child(7) { animation-delay: 0.9s; }
  .step:nth-child(8) { animation-delay: 1.0s; }

  .step-icon {
    width: 30px; height: 30px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 13px;
    font-weight: 700;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .step-icon.pass { background: var(--success-bg); color: var(--success); border: 1.5px solid var(--success-border); }
  .step-icon.fail { background: var(--danger-bg); color: var(--danger); border: 1.5px solid var(--danger-border); }
  .step-icon.warn { background: var(--warn-bg); color: var(--warn); border: 1.5px solid #fde68a; }

  .step-body { flex: 1; }

  .step-name {
    font-size: 13.5px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 2px;
  }

  .step-detail {
    font-size: 11.5px;
    color: var(--muted);
    font-weight: 400;
  }

  .step-time {
    font-size: 11px;
    font-weight: 500;
    color: var(--muted);
    white-space: nowrap;
    align-self: center;
    background: var(--bg);
    padding: 2px 8px;
    border-radius: 6px;
  }

  /* Sidebar */
  .sidebar { display: flex; flex-direction: column; gap: 16px; }

  /* Result */
  .result-row {
    padding: 20px 22px;
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .result-row.pass { background: linear-gradient(135deg, var(--success-bg), #f0fdf4); }
  .result-row.fail { background: linear-gradient(135deg, var(--danger-bg), #fff5f5); }

  .result-icon {
    width: 44px; height: 44px;
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px;
  }

  .result-icon.pass { background: var(--success-bg); border: 1.5px solid var(--success-border); }
  .result-icon.fail { background: var(--danger-bg); border: 1.5px solid var(--danger-border); }

  .result-text .label {
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 2px;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 3px;
  }

  .result-text .value {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  /* Filter rows */
  .filter-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 22px;
    border-bottom: 1px solid var(--border);
  }

  .filter-row:last-child { border-bottom: none; }

  .filter-key {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--muted);
  }

  .filter-val {
    font-size: 12px;
    font-weight: 500;
    color: var(--text2);
    background: var(--bg);
    padding: 4px 10px;
    border-radius: 6px;
    border: 1px solid var(--border2);
  }

  /* Execution time row */
  .exec-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 22px;
    background: var(--accent2-bg);
    border-top: 1px solid var(--border);
  }

  .exec-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--accent2);
  }

  .exec-val {
    font-size: 18px;
    font-weight: 800;
    color: var(--accent2);
  }

  /* Bar chart */
  .bar-chart { padding: 16px 22px; }

  .bar-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    animation: fadeRight 0.5s ease both;
  }

  .bar-label {
    font-size: 10px;
    font-weight: 600;
    color: var(--muted);
    width: 60px;
    flex-shrink: 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .bar-track {
    flex: 1;
    height: 7px;
    background: var(--bg);
    border-radius: 4px;
    overflow: hidden;
    border: 1px solid var(--border);
  }

  .bar-fill {
    height: 100%;
    border-radius: 4px;
    width: 0;
    transition: width 1.2s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .bar-count {
    font-size: 10px;
    font-weight: 600;
    color: var(--muted);
    width: 28px;
    text-align: right;
  }

  /* Terminal */
  .terminal {
    background: #1e1e2e;
    border-radius: 0 0 14px 14px;
    padding: 16px 20px;
    font-family: 'Courier New', monospace;
    font-size: 11.5px;
    line-height: 1.9;
    max-height: 170px;
    overflow-y: auto;
  }

  .log-line { display: flex; gap: 12px; }
  .log-time { color: #4a4a6a; }
  .log-msg.ok  { color: #4ade80; }
  .log-msg.info { color: #818cf8; }
  .log-msg.warn { color: #facc15; }
  .log-msg.err  { color: #f87171; }

  /* Error banner */
  .error-banner {
    background: var(--danger-bg);
    border: 1.5px solid var(--danger-border);
    border-radius: 12px;
    padding: 16px 22px;
    font-size: 13px;
    color: var(--danger);
    font-weight: 500;
    margin-bottom: 20px;
    display: none;
  }

  /* Animations */
  @keyframes fadeDown  { from { opacity:0; transform:translateY(-16px); } to { opacity:1; transform:translateY(0); } }
  @keyframes fadeUp    { from { opacity:0; transform:translateY(16px);  } to { opacity:1; transform:translateY(0); } }
  @keyframes fadeRight { from { opacity:0; transform:translateX(-10px); } to { opacity:1; transform:translateX(0); } }
  @keyframes pulse     { 0%,100% { opacity:1; transform:scale(1); } 50% { opacity:0.5; transform:scale(0.85); } }

  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }
</style>
</head>
<body>

<!-- Loading overlay -->
<div id="loading-overlay">
  <div class="spinner"></div>
  <div class="loading-text">Loading test results‚Ä¶</div>
</div>

<div class="top-bar"></div>

<div class="container">

  <!-- Error banner (shown if report.json fails) -->
  <div class="error-banner" id="error-banner">
    ‚ö†Ô∏è Could not load <code>report.json</code>. Make sure the dashboard is served via <code>http://localhost:8000</code> and the test has completed.
  </div>

  <!-- Header -->
  <header>
    <div class="logo-block">
      <div class="eyebrow">// Selenium QA</div>
      <h1>Daraz <span>Automation</span></h1>
    </div>
    <div class="header-right">
      <div class="status-pill pass" id="status-pill">
        <div class="dot"></div>
        <span id="status-text">LOADING‚Ä¶</span>
      </div>
      <div class="run-time">Run: <span id="run-time">‚Äî</span></div>
    </div>
  </header>

  <!-- Stats -->
  <div class="stats-grid">
    <div class="stat-card" style="--i:0">
      <div class="stat-icon">üìã</div>
      <div class="stat-label">Steps Run</div>
      <div class="stat-value" style="color:var(--accent2);">8</div>
      <div class="stat-sub">all completed</div>
    </div>
    <div class="stat-card" style="--i:1">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-label">Passed</div>
      <div class="stat-value" style="color:var(--success);" id="passed-val">‚Äî</div>
      <div class="stat-sub">assertions ok</div>
    </div>
    <div class="stat-card" style="--i:2">
      <div class="stat-icon">üõçÔ∏è</div>
      <div class="stat-label">Products Found</div>
      <div class="stat-value" id="product-count" style="color:var(--accent);">‚Äî</div>
      <div class="stat-sub">after filters</div>
    </div>
    <div class="stat-card" style="--i:3">
      <div class="stat-icon">üöö</div>
      <div class="stat-label">Free Shipping</div>
      <div class="stat-value" id="shipping-val">‚Äî</div>
      <div class="stat-sub">on first product</div>
    </div>
  </div>

  <!-- Main grid -->
  <div class="main-grid">

    <!-- Steps panel -->
    <div class="panel" style="animation-delay:0.2s">
      <div class="panel-header">
        <span class="panel-title">Test Steps</span>
        <span class="panel-badge">8 / 8</span>
      </div>
      <div class="steps">
        <div class="step">
          <div class="step-icon pass">‚úì</div>
          <div class="step-body">
            <div class="step-name">Open Browser</div>
            <div class="step-detail">Chrome launched, maximized</div>
          </div>
          <div class="step-time">~0.8s</div>
        </div>
        <div class="step">
          <div class="step-icon pass">‚úì</div>
          <div class="step-body">
            <div class="step-name">Navigate to Daraz.pk</div>
            <div class="step-detail">https://www.daraz.pk loaded</div>
          </div>
          <div class="step-time">~1.4s</div>
        </div>
        <div class="step">
          <div class="step-icon pass">‚úì</div>
          <div class="step-body">
            <div class="step-name">Search Product</div>
            <div class="step-detail" id="step-search">Query: electronics</div>
          </div>
          <div class="step-time">~2.1s</div>
        </div>
        <div class="step">
          <div class="step-icon pass">‚úì</div>
          <div class="step-body">
            <div class="step-name">Apply Brand Filter</div>
            <div class="step-detail" id="step-brand">Brand: ‚Äî</div>
          </div>
          <div class="step-time">~3.5s</div>
        </div>
        <div class="step">
          <div class="step-icon pass">‚úì</div>
          <div class="step-body">
            <div class="step-name">Apply Price Filter</div>
            <div class="step-detail" id="step-price">Range: PKR ‚Äî</div>
          </div>
          <div class="step-time">~4.2s</div>
        </div>
        <div class="step">
          <div class="step-icon pass">‚úì</div>
          <div class="step-body">
            <div class="step-name">Count Products</div>
            <div class="step-detail" id="count-detail">Assertion: count > 0</div>
          </div>
          <div class="step-time">~5.0s</div>
        </div>
        <div class="step">
          <div class="step-icon pass" id="step7-icon">‚úì</div>
          <div class="step-body">
            <div class="step-name">Open First Product</div>
            <div class="step-detail" id="step7-detail">Clicked product [0], new tab</div>
          </div>
          <div class="step-time">~6.3s</div>
        </div>
        <div class="step">
          <div class="step-icon warn" id="step8-icon">!</div>
          <div class="step-body">
            <div class="step-name">Check Free Shipping</div>
            <div class="step-detail" id="shipping-detail">Checking‚Ä¶</div>
          </div>
          <div class="step-time">~7.1s</div>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">

      <!-- Result card -->
      <div class="panel" style="animation-delay:0.3s">
        <div class="panel-header">
          <span class="panel-title">Overall Result</span>
        </div>
        <div class="result-row pass" id="result-row">
          <div class="result-icon pass" id="result-icon">üü¢</div>
          <div class="result-text">
            <div class="label">Status</div>
            <div class="value" id="result-value" style="color:var(--success);">‚Äî</div>
          </div>
        </div>
        <div class="exec-row">
          <span class="exec-label">‚è± Execution Time</span>
          <span class="exec-val" id="exec-time">‚Äîs</span>
        </div>
      </div>

      <!-- Filters -->
      <div class="panel" style="animation-delay:0.4s">
        <div class="panel-header">
          <span class="panel-title">Filters Applied</span>
        </div>
        <div class="filter-row">
          <span class="filter-key">Search</span>
          <span class="filter-val" id="f-search">‚Äî</span>
        </div>
        <div class="filter-row">
          <span class="filter-key">Brand</span>
          <span class="filter-val" id="f-brand">‚Äî</span>
        </div>
        <div class="filter-row">
          <span class="filter-key">Price Range</span>
          <span class="filter-val" id="f-price">‚Äî</span>
        </div>
      </div>

      <!-- Bar chart -->
      <div class="panel" style="animation-delay:0.5s">
        <div class="panel-header">
          <span class="panel-title">Time per Step (s)</span>
        </div>
        <div class="bar-chart">
          <div class="bar-row" style="animation-delay:0.5s">
            <div class="bar-label">Launch</div>
            <div class="bar-track"><div class="bar-fill" data-w="11" style="background:var(--accent2);"></div></div>
            <div class="bar-count">0.8</div>
          </div>
          <div class="bar-row" style="animation-delay:0.6s">
            <div class="bar-label">Navigate</div>
            <div class="bar-track"><div class="bar-fill" data-w="20" style="background:var(--accent2);"></div></div>
            <div class="bar-count">1.4</div>
          </div>
          <div class="bar-row" style="animation-delay:0.7s">
            <div class="bar-label">Search</div>
            <div class="bar-track"><div class="bar-fill" data-w="30" style="background:var(--accent);"></div></div>
            <div class="bar-count">2.1</div>
          </div>
          <div class="bar-row" style="animation-delay:0.8s">
            <div class="bar-label">Brand</div>
            <div class="bar-track"><div class="bar-fill" data-w="50" style="background:var(--accent);"></div></div>
            <div class="bar-count">3.5</div>
          </div>
          <div class="bar-row" style="animation-delay:0.9s">
            <div class="bar-label">Price</div>
            <div class="bar-track"><div class="bar-fill" data-w="60" style="background:var(--accent);"></div></div>
            <div class="bar-count">4.2</div>
          </div>
          <div class="bar-row" style="animation-delay:1.0s">
            <div class="bar-label">Count</div>
            <div class="bar-track"><div class="bar-fill" data-w="72" style="background:var(--success);"></div></div>
            <div class="bar-count">5.0</div>
          </div>
          <div class="bar-row" style="animation-delay:1.1s">
            <div class="bar-label">Open</div>
            <div class="bar-track"><div class="bar-fill" data-w="90" style="background:var(--success);"></div></div>
            <div class="bar-count">6.3</div>
          </div>
          <div class="bar-row" style="animation-delay:1.2s">
            <div class="bar-label">Shipping</div>
            <div class="bar-track"><div class="bar-fill" data-w="100" style="background:var(--warn);"></div></div>
            <div class="bar-count">7.1</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Terminal -->
  <div class="panel" style="animation: fadeUp 0.6s ease 0.55s both;">
    <div class="panel-header">
      <span class="panel-title">Console Output</span>
      <span class="panel-badge">stdout</span>
    </div>
    <div class="terminal" id="terminal"></div>
  </div>

</div>

<script>
  // ‚îÄ‚îÄ Populate dashboard from report.json ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  async function loadResults() {
    try {
      const res = await fetch('report.json');
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      applyData(data);
    } catch (e) {
      console.warn('Could not load report.json:', e);
      document.getElementById('error-banner').style.display = 'block';
      // Show placeholder so UI isn't broken
      applyData({
        test_name: 'Daraz Automation Test',
        search_term: '‚Äî',
        brand: '‚Äî',
        price_range: '‚Äî',
        product_count: 0,
        free_shipping: false,
        status: 'FAIL',
        execution_time_seconds: 0
      });
    } finally {
      // Hide loading overlay
      const overlay = document.getElementById('loading-overlay');
      overlay.classList.add('hidden');
      setTimeout(() => overlay.remove(), 500);
    }
  }

  function applyData(data) {
    const isPassed = data.status === 'PASS';
    const hasShipping = data.free_shipping === true || data.free_shipping === 'True';

    // Header timestamp
    document.getElementById('run-time').textContent = new Date().toLocaleString();

    // Status pill
    const pill = document.getElementById('status-pill');
    pill.className = 'status-pill ' + (isPassed ? 'pass' : 'fail');
    document.getElementById('status-text').textContent = isPassed ? 'TEST PASSED' : 'TEST FAILED';

    // Stat cards
    document.getElementById('passed-val').textContent = isPassed ? '7' : '‚Äî';
    document.getElementById('product-count').textContent = data.product_count;

    const shippingEl = document.getElementById('shipping-val');
    shippingEl.textContent = hasShipping ? 'YES' : 'NO';
    shippingEl.style.color = hasShipping ? 'var(--success)' : 'var(--danger)';

    // Step details (dynamic from JSON)
    document.getElementById('step-search').textContent  = `Query: "${data.search_term}"`;
    document.getElementById('step-brand').textContent   = `Brand: ${data.brand}`;
    document.getElementById('step-price').textContent   = `Range: PKR ${data.price_range}`;
    document.getElementById('count-detail').textContent = `Found ${data.product_count} products ‚Äî assertion ${data.product_count > 0 ? 'passed ‚úì' : 'FAILED ‚úó'}`;

    // Step 7 ‚Äî open product
    if (data.product_count === 0) {
      document.getElementById('step7-icon').className = 'step-icon fail';
      document.getElementById('step7-icon').textContent = '‚úó';
      document.getElementById('step7-detail').textContent = 'Skipped ‚Äî no products found';
    }

    // Step 8 ‚Äî shipping
    const s8icon = document.getElementById('step8-icon');
    const s8detail = document.getElementById('shipping-detail');
    if (hasShipping) {
      s8icon.className = 'step-icon pass';
      s8icon.textContent = '‚úì';
      s8detail.textContent = '‚úì Free Shipping label found';
    } else {
      s8icon.className = 'step-icon warn';
      s8icon.textContent = '!';
      s8detail.textContent = '‚úó Free Shipping label not found';
    }

    // Overall result card
    const resultRow  = document.getElementById('result-row');
    const resultIcon = document.getElementById('result-icon');
    const resultVal  = document.getElementById('result-value');
    resultRow.className  = 'result-row ' + (isPassed ? 'pass' : 'fail');
    resultIcon.className = 'result-icon ' + (isPassed ? 'pass' : 'fail');
    resultIcon.textContent = isPassed ? 'üü¢' : 'üî¥';
    resultVal.textContent  = isPassed ? 'PASSED' : 'FAILED';
    resultVal.style.color  = isPassed ? 'var(--success)' : 'var(--danger)';

    // Execution time
    document.getElementById('exec-time').textContent = data.execution_time_seconds + 's';

    // Filters panel
    document.getElementById('f-search').textContent = data.search_term;
    document.getElementById('f-brand').textContent  = data.brand;
    document.getElementById('f-price').textContent  = `PKR ${data.price_range}`;

    // Animate bars
    setTimeout(() => {
      document.querySelectorAll('.bar-fill').forEach(el => {
        el.style.width = el.dataset.w + '%';
      });
    }, 400);

    // Terminal logs
    renderLogs(data, hasShipping, isPassed);
  }

  function renderLogs(data, hasShipping, isPassed) {
    const logs = [
      { t: '00:00.0', msg: 'Browser opened!',                                           cls: 'ok'   },
      { t: '00:01.4', msg: 'Opened Daraz.pk',                                           cls: 'ok'   },
      { t: '00:02.1', msg: `Searched for "${data.search_term}"`,                        cls: 'ok'   },
      { t: '00:03.5', msg: `Applied brand filter: ${data.brand}`,                       cls: 'ok'   },
      { t: '00:04.2', msg: `Applied price filter ${data.price_range}`,                  cls: 'ok'   },
      { t: '00:05.0', msg: `Products found: ${data.product_count}`,                     cls: 'info' },
      { t: '00:06.3', msg: data.product_count > 0 ? 'Opened first product' : 'Skipped opening ‚Äî no products', cls: data.product_count > 0 ? 'ok' : 'warn' },
      { t: '00:07.1', msg: `Free Shipping Available: ${hasShipping}`,                   cls: hasShipping ? 'ok' : 'warn' },
      { t: '00:07.2', msg: `Test completed ‚Äî ${data.status} in ${data.execution_time_seconds}s`, cls: isPassed ? 'ok' : 'err' },
    ];

    const terminal = document.getElementById('terminal');
    logs.forEach((log, i) => {
      setTimeout(() => {
        const line = document.createElement('div');
        line.className = 'log-line';
        line.innerHTML = `<span class="log-time">[${log.t}]</span><span class="log-msg ${log.cls}">${log.msg}</span>`;
        terminal.appendChild(line);
        terminal.scrollTop = terminal.scrollHeight;
      }, 600 + i * 180);
    });
  }

  loadResults();
</script>
</body>
</html>